import{j as e}from"./index-8161c266.js";import{r as a,L as M,c as H}from"./react-vendor-36975316.js";import{F as te}from"./FlankerResult-51025eab.js";import{C as N,c as I,b as P,a as w,B as v}from"./button-71acd156.js";import{L as U,I as V,P as se}from"./label-5239e133.js";import{U as K,C as ae,S as re,A as le,P as ne,a as ce,B as W,b as Y,D as ie,R as oe,c as de}from"./ui-vendor-b175fcb0.js";import{c as me}from"./utils-a3ea4c3f.js";function xe({onStart:s}){const[n,m]=a.useState(""),[i,l]=a.useState(""),[o,h]=a.useState(!1),S=u=>{u.preventDefault(),n.trim()&&i.trim()&&s(n.trim(),i.trim(),o)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-6",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm border-slate-200/60 shadow-2xl",children:[e.jsxs(I,{className:"text-center pb-4",children:[e.jsx(P,{className:"text-2xl font-bold text-slate-900",children:"Flanker Task Setup"}),e.jsx("p",{className:"text-slate-600 mt-2",children:"Please enter your information to begin"})]}),e.jsx(w,{children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{htmlFor:"name",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(K,{className:"w-4 h-4"}),"Full Name"]}),e.jsx(V,{id:"name",type:"text",placeholder:"Enter your full name",value:n,onChange:u=>m(u.target.value),className:"h-12 bg-white/60 border-slate-200 focus:border-blue-400",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{htmlFor:"studentId",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(ae,{className:"w-4 h-4"}),"Student ID"]}),e.jsx(V,{id:"studentId",type:"text",placeholder:"Enter your student ID",value:i,onChange:u=>l(u.target.value),className:"h-12 bg-white/60 border-slate-200 focus:border-blue-400",required:!0})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("input",{id:"shareData",type:"checkbox",checked:o,onChange:u=>h(u.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(U,{htmlFor:"shareData",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(re,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-700",children:"Share my data with class"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:o?"Your results will be included in class aggregates and visible to instructors.":"Your data will be kept private and not shared with the class."})]})]}),!o&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx(le,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-amber-700",children:[e.jsx("strong",{children:"Private mode:"})," Your individual results will still be available for download at the end, but won't appear in class statistics or instructor dashboards."]})]})]}),e.jsxs(v,{type:"submit",className:"w-full h-12 bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg",disabled:!n.trim()||!i.trim(),children:[e.jsx(ne,{className:"w-5 h-5 mr-2"}),"Begin Task"]})]})})]})})})}function ue({showStimulus:s,stimulus:n,awaitingResponse:m,feedback:i}){const l=()=>!i||!i.show?"opacity-0":i.correct?"text-emerald-600 opacity-100":"text-red-600 opacity-100";return e.jsxs("div",{className:"h-48 w-full flex flex-col items-center justify-center transition-all duration-200",children:[e.jsx("div",{className:"h-24 flex items-center justify-center",children:s?e.jsx("div",{className:"text-6xl font-mono font-bold text-slate-900 tracking-wider select-none",children:n==null?void 0:n.display}):e.jsx("div",{className:"text-6xl font-bold text-slate-800 select-none",children:"+"})}),e.jsx("div",{className:"h-8 mt-4 text-xl font-semibold transition-opacity duration-300",children:i&&e.jsx("span",{className:l(),children:i.text})})]})}function he({results:s,studentInfo:n}){const m=s.filter(t=>t.is_correct).length,i=m/s.length*100,l=s.filter(t=>t.is_correct&&t.participant_response!=="timeout").reduce((t,f)=>t+f.reaction_time,0)/m,o=s.filter(t=>t.stimulus_type==="congruent"),h=s.filter(t=>t.stimulus_type==="incongruent");o.filter(t=>t.is_correct).length/o.length*100,h.filter(t=>t.is_correct).length/h.length*100;const S=o.filter(t=>t.is_correct&&t.participant_response!=="timeout").reduce((t,f)=>t+f.reaction_time,0)/o.filter(t=>t.is_correct).length,F=h.filter(t=>t.is_correct&&t.participant_response!=="timeout").reduce((t,f)=>t+f.reaction_time,0)/h.filter(t=>t.is_correct).length-S,p=()=>{const f=[["Student Name","Student ID","Trial","Stimulus Type","Stimulus Display","Correct Response","Participant Response","Reaction Time (ms)","Correct","Session Start"].join(","),...s.map(x=>[`"${x.student_name}"`,`"${x.student_id}"`,x.trial_number,x.stimulus_type,`"${x.stimulus_display}"`,x.correct_response,x.participant_response,x.reaction_time,x.is_correct,x.session_start_time].join(","))].join(`
`),T=new Blob([f],{type:"text/csv"}),y=URL.createObjectURL(T),b=document.createElement("a");b.href=y,b.download=`flanker_results_${n.name.replace(/\s+/g,"_")}_${Date.now()}.csv`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(y)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(ce,{className:"w-20 h-20 text-emerald-600 mx-auto mb-6"}),e.jsx("h1",{className:"text-4xl font-bold text-slate-900 mb-4",children:"Experiment Complete!"}),e.jsxs("p",{className:"text-xl text-slate-600 mb-2",children:["Thank you for participating, ",n.name]}),e.jsx("p",{className:"text-lg text-slate-500",children:"Your data has been successfully recorded for analysis"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm border-slate-200/60 shadow-xl",children:[e.jsx(I,{children:e.jsxs(P,{className:"text-xl flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-blue-600"}),"Your Performance"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-emerald-700",children:[i.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-emerald-600",children:"Accuracy"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[l.toFixed(0),"ms"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"Avg Response Time"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600",children:"Flanker Effect:"}),e.jsxs("span",{className:"font-semibold text-lg text-purple-600",children:["+",F.toFixed(0),"ms"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Difference between incongruent and congruent trials"})]})]})]}),e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm border-slate-200/60 shadow-xl",children:[e.jsx(I,{children:e.jsx(P,{className:"text-xl",children:"What's Next?"})}),e.jsxs(w,{className:"space-y-4",children:[e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Your individual results contribute to class-wide data analysis. View the results dashboard to see how your performance compares with other students and explore the cognitive patterns revealed by the Flanker task."}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium mb-2",children:"Class Discussion Points:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• How does attention affect response time?"}),e.jsx("li",{children:"• What causes the flanker effect?"}),e.jsx("li",{children:"• Individual vs. group differences"})]})]})]})]})]}),e.jsx(N,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white mb-6",children:e.jsxs(w,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Explore the Class Results"}),e.jsx("p",{className:"text-blue-100 mb-6 text-lg",children:"See how your performance fits into the broader cognitive psychology patterns and compare results across all participants."}),e.jsx(M,{to:me("Results"),children:e.jsxs(v,{size:"lg",className:"bg-white text-blue-600 hover:bg-blue-50 font-semibold text-lg px-8 py-3",children:[e.jsx(W,{className:"w-5 h-5 mr-2"}),"View Results Dashboard",e.jsx(Y,{className:"w-5 h-5 ml-2"})]})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[e.jsx(M,{to:"/",children:e.jsxs(v,{className:"bg-blue-600 hover:bg-blue-700 font-semibold px-6",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Return to Home"]})}),e.jsxs(v,{onClick:p,variant:"outline",className:"bg-white border-slate-200 hover:bg-slate-50 font-semibold px-6",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Download My Data"]}),e.jsx(M,{to:"/flanker",children:e.jsxs(v,{variant:"outline",className:"bg-white border-slate-200 hover:bg-slate-50 font-semibold px-6",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Take Task Again"]})})]})]})})}function pe({onStartExperiment:s}){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-6",children:e.jsx("div",{className:"w-full max-w-md text-center",children:e.jsxs(N,{className:"bg-white/80 backdrop-blur-sm border-slate-200/60 shadow-2xl",children:[e.jsxs(I,{children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(de,{className:"w-10 h-10 text-emerald-600"})}),e.jsx(P,{className:"text-2xl font-bold text-slate-900",children:"Practice Complete!"})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsx("p",{className:"text-slate-600 text-lg leading-relaxed",children:"You're ready to begin the main experiment. The following trials will be recorded."}),e.jsxs("p",{className:"text-slate-600",children:["Remember to respond as ",e.jsx("strong",{children:"quickly and accurately"})," as possible."]}),e.jsxs(v,{onClick:s,className:"w-full h-12 bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg text-lg",children:["Start Experiment",e.jsx(Y,{className:"w-5 h-5 ml-2"})]})]})]})})})}const D=40,E=10,z=2e3,G=[{display:"<<<<<",type:"congruent",correct:"left"},{display:">>>>>",type:"congruent",correct:"right"},{display:"<<><<",type:"incongruent",correct:"right"},{display:">><>>",type:"incongruent",correct:"left"}];function ve(){const[s,n]=a.useState("setup"),[m,i]=a.useState({name:"",id:"",shareData:!1}),[l,o]=a.useState(0),[h,S]=a.useState(null),[u,F]=a.useState(null),[p,t]=a.useState(null),[f,T]=a.useState(!1),[y,b]=a.useState(!1),[x,J]=a.useState([]),[_,B]=a.useState([]),[Q,A]=a.useState(null),L=H.useRef(!1),C=H.useRef(null),O=a.useCallback(d=>{const r=[],j=Math.ceil(d/2),R=Math.floor(d/2);for(let c=0;c<j;c++)r.push(G[Math.floor(Math.random()*2)]);for(let c=0;c<R;c++)r.push(G[2+Math.floor(Math.random()*2)]);for(let c=r.length-1;c>0;c--){const g=Math.floor(Math.random()*(c+1));[r[c],r[g]]=[r[g],r[c]]}return r.slice(0,d)},[]),k=a.useCallback(async(d,r)=>{if(L.current||!p)return;L.current=!0,b(!1),clearTimeout(C.current);const j=d===p.correct;if(s==="practice")A({show:!0,text:d==="timeout"?"Too Slow":j?"Correct!":"Incorrect",correct:j}),setTimeout(()=>{l+1>=E?n("practice_complete"):o(c=>c+1)},800);else{const R=r||performance.now()-u,c={student_name:m.name,student_id:m.id,trial_number:l+1,stimulus_type:p.type,stimulus_display:p.display,correct_response:p.correct,participant_response:d,reaction_time:Math.round(R),is_correct:j,session_start_time:h,task_type:"flanker",share_data:m.shareData};J(g=>[...g,c]);try{await te.create(c,m.shareData)}catch(g){console.error("Error saving result:",g)}T(!1),l+1>=D?setTimeout(()=>n("complete"),500):setTimeout(()=>o(g=>g+1),200)}},[s,p,u,m,l,h]),q=a.useCallback(()=>{if(l>=(s==="practice"?E:D))return;L.current=!1,A(null),clearTimeout(C.current);const r=_[l];t(r),T(!1),setTimeout(()=>{T(!0),F(performance.now()),b(!0),C.current=setTimeout(()=>k("timeout",z),z)},500)},[l,_,s,k]),X=(d,r,j=!1)=>{i({name:d,id:r,shareData:j}),S(new Date().toISOString()),B(O(E)),o(0),n("practice")},Z=()=>{n("task"),o(0),B(O(D)),A(null)};if(a.useEffect(()=>{const d=r=>{y&&(r.key==="ArrowLeft"?k("left"):r.key==="ArrowRight"&&k("right"))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[y,k]),a.useEffect(()=>{if((s==="task"||s==="practice")&&_.length>0){const r=setTimeout(q,l===0?1e3:800);return()=>clearTimeout(r)}},[s,l,_,q]),a.useEffect(()=>()=>clearTimeout(C.current),[]),s==="setup")return e.jsx(xe,{onStart:X});if(s==="practice_complete")return e.jsx(pe,{onStartExperiment:Z});if(s==="complete")return e.jsx(he,{results:x,studentInfo:m});const $=s==="practice"?E:D,ee=s==="practice"?"Practice Trial":"Trial";return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsx(N,{className:"mb-8 bg-white/80 backdrop-blur-sm border-slate-200/60 shadow-lg",children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"font-medium text-slate-900",children:m.name})]}),e.jsxs("div",{className:"text-sm text-slate-600",children:[ee," ",l+1," of ",$]})]}),e.jsx(se,{value:(l+1)/$*100,className:"h-2"})]})}),e.jsx(N,{className:"bg-white/90 backdrop-blur-sm border-slate-200/60 shadow-2xl",children:e.jsx(w,{className:"p-6",children:e.jsx(ue,{showStimulus:f,stimulus:p,awaitingResponse:y,feedback:Q})})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-6 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs",children:"←"}),e.jsx("span",{children:"Left Arrow"})]}),e.jsx("div",{className:"w-px h-4 bg-slate-300"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs",children:"→"}),e.jsx("span",{children:"Right Arrow"})]})]})})]})})}export{ve as default};
